{"version":3,"sources":["pb-gest-product.js"],"names":[],"mappings":"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","file":"pb-gest-product.js","sourcesContent":["/*! pb-gest-product 0.4.0 - Copyright 2015 Palmabit <hello@palmabit.com> (http://www.palmabit.com) */\n'use strict';\n\nclass ItemFactory {\n  constructor(item) {\n    this.item = item;\n\n    if (!item) {\n      throw new Error('item must be an object');\n    }\n\n    if (item.intangible) {\n      return new ItemIntangible(item);\n    } else if (item.hasLots) {\n      return new ItemLots(item);\n    } else {\n      return new ItemNoLots(item);\n    }\n  }\n}\n\n'use strict';\n\nclass ItemManager {\n  constructor(item) {\n    if (!item) {\n      throw new Error('item must be an object');\n    }\n\n    item.quantity = item.quantity || 0;\n    this.item = item;\n  }\n\n  get() {\n    return this.item;\n  }\n\n  set(item) {\n    this.item = item;\n  }\n\n  decrement() {\n    var item = this.item;\n\n    if (item.quantity > 0) {\n      item.quantity -= 1;\n    }\n\n    return this;\n  }\n\n  increment() {\n    var item = this.item;\n\n    if (item.intangible || item.quantity < item.maxQty) {\n      item.quantity += 1;\n    }\n\n    return this;\n  }\n}\n\n'use strict';\n\nclass ProductItemConverter {\n  constructor() {\n    this.items = [];\n    this.maxReached = [];\n    this.products = [];\n  }\n\n  add(products, items) {\n    this.products = [];\n    this.items = items;\n    this.maxReached = [];\n\n    for (let product of products) {\n      this._addProduct(product);\n    }\n\n    return this._merge();\n  }\n\n  get() {\n    return this.items;\n  }\n\n  getMaxReached() {\n    return this.maxReached;\n  }\n\n  hasErrors() {\n    return this.maxReached.length > 0;\n  }\n\n  _addProduct(product) {\n    if (!product) {\n      return;\n    }\n\n    product.hasLots === true ? this._addProductWithLots(product) : this._addProductWithoutLots(product);\n  }\n\n  _addProductWithLots(product) {\n    //Split lots\n    for (let lot of product.lots) {\n      let item;\n\n      if (!lot.quantity || lot.quantity === 0) {\n        continue;\n      }\n\n      item = this._create(product, lot);\n\n      if (item.lots) {\n        delete item.lots;\n      }\n\n      this.products.push(item);\n    }\n  }\n\n  _addProductWithoutLots(product) {\n    var item = product.intangible === true ? product : this._create(product, product.noLots);\n\n    if (item.noLots) {\n      delete item.noLots;\n    }\n\n    this.products.push(item);\n  }\n\n  _create(product, lot) {\n    lot = lot || {};\n\n    return Object.assign({}, product, {\n      quantity: lot.quantity,\n      maxQty: lot.maxQty,\n      lot: {\n        lot: lot.lot,\n        date: lot.date,\n        expiration: lot.expiration\n      },\n      warehouse: lot.warehouse\n    });\n  }\n\n  _merge() {\n    for (let product of this.products) {\n      let found = false;\n\n      for (let item of this.items) {\n        if (product._id !== item._id) {\n          continue;\n        }\n\n        if (product.hasLots !== true) {\n          found = true;\n          this._incrementItems(product, item);\n        } else if (product.lot && item.lot && product.lot.lot === item.lot.lot) {\n          found = true;\n          this._incrementItems(product, item);\n        }\n      };\n\n      if (!found) {\n        this.items.push(product);\n      }\n    };\n  }\n\n  _incrementItems(product, item) {\n    if (product.intangible === true || product.quantity + item.quantity <= item.maxQty) {\n      item.quantity = product.quantity + item.quantity;\n    } else {\n      item.quantity = item.maxQty;\n\n      this.maxReached.push({\n        description: item.description,\n        lot: item.lot && item.lot.lot ? item.lot.lot : '-'\n      });\n    }\n  }\n}\n\n'use strict';\n\nclass ProductPresenter {\n  constructor (user) {\n    this.user = user || {};\n  }\n\n  presentList (products) {\n    var i;\n\n    for (i = 0; i < products.length; i += 1) {\n      this.present(products[i]);\n    }\n\n    return products;\n  }\n\n  present(product) {\n    if (typeof product !== 'object') {\n      throw new TypeError('product must be an object');\n    }\n\n    if (!product.price) {\n      this.getPrice(product);\n    }\n\n    this.getQuantity(product);\n\n    return product;\n  }\n\n  getPrice(product) {\n    var i, user = this.user;\n    // var products = user.products || [];\n\n    // for (i = 0; i < products.length; i += 1) {\n    //   if (product && products[i].product === product._id) {\n    //     product.price = products[i].price_customer;\n    //     return product;\n    //   }\n    // }\n\n    if (this.getListPrice(product, user.list)) {            //priority 1\n      return product;\n    }\n    if (this.getListPrice(product, user.list_default)) {    //priority 2\n      return product;\n    }\n    if (this.getListPrice(product, user.list_active)) {     //priority 3\n      return product;\n    }\n\n    product.price = 0;\n    return product;\n  }\n\n  getListPrice(product, list) {\n    if (!Array.isArray(product.prices) || !list) {\n      return\n    }\n\n    for (var i = 0; i < product.prices.length; i += 1) {\n      if (product.prices[i].list === list._id) {\n        product.price = product.prices[i].price;\n        return product;\n      }\n    }\n  }\n\n  getQuantity(product) {\n    if (product.intangible === true) {\n      return product;\n    }\n\n    return this.getTangibleQuantity(product);\n  }\n\n  getTangibleQuantity(product) {\n    if (product.hasLots) {\n      return this.getQuantityFromLots(product);\n    } else if (product.noLots) {\n      product.quantity = product.noLots.quantity;\n      return product;\n    }\n  }\n\n  getQuantityFromLots(product) {\n    if (product.lots && product.lots.length > 0) {\n      product.quantity = 0;\n\n      product.lots.sort(function (a, b) {\n        return new Date(a.expiration) - new Date(b.expiration);\n      });\n\n      for (var i = 0; i < product.lots.length; i += 1) {\n        product.quantity += product.lots[i].quantity;\n      }\n    }\n\n    return product;\n  }\n}\n\n'use strict';\n\nclass ProductVatPresenter extends ProductPresenter {\n\n  present(product) {\n    super.present(product);\n    product.vat = this.getVat(product);\n    return product;\n  }\n\n  getVat(product) {\n    product.rate_reduced = product.rate_reduced || [];\n\n    if (product.rate_exemption) {             //product's vat exemption\n      return product.rate_exemption;\n    } else if (this.user.rate_exemption) {    //user's vat exemption\n      return this.user.rate_exemption;\n    } else if (this.user.rate) {              //user's vat reduced\n      return this.getVatReduced(product);\n    } else if (product.rate) {                //product's regular vat\n      return product.rate;\n    } else {                                  //default vat\n      return this.user.rate_default || null;\n    }\n  }\n\n  getVatReduced(product) {\n    var i, reduced;\n\n    for (i = 0; i < product.rate_reduced.length; i += 1) {\n      reduced = product.rate_reduced[i];\n\n      if (reduced && reduced.name === this.user.rate) {\n        return reduced.vat;\n      }\n    }\n\n    //Product's regular vat is returned if reduced one is not found\n    return product.rate;\n  }\n}\n\n'use strict';\n\nclass ItemIntangible {\n  constructor(item) {\n    item = item || {};\n    //Set initial quantity\n    item.quantity = 1;\n\n    this.item = item;\n  }\n\n  get() {\n    return this.item;\n  }\n\n  set(item) {\n    this.item = item;\n  }\n\n  decrement(index) {\n    var item = this.item;\n    item.quantity = parseInt(item.quantity || 0);\n\n    if (item.quantity > 0) {\n      item.quantity -= 1;\n    }\n\n    return this;\n  }\n\n  increment(index) {\n    var item = this.item;\n    item.quantity = parseInt(item.quantity || 0);\n    item.quantity += 1;\n    return this;\n  }\n}\n\n'use strict';\n\nclass ItemLots {\n  constructor(item) {\n    item = item || {};\n    item.lots = item.lots || [];\n\n    this.item = item;\n\n    //Set max quantity and initial quantity\n    item.lots.forEach(function (lot, i) {\n      lot.maxQty = lot.quantity;\n      lot.quantity = i == 0 ? 1 : 0;\n    });\n  }\n\n  get() {\n    return this.item;\n  }\n\n  set(item) {\n    this.item = item;\n  }\n\n  decrement(index) {\n    var item = this.item;\n\n    if (item.lots.length === 0) {\n      return this;\n    }\n\n    index = index || item.lots.length - 1;\n    item.lots[index].quantity = parseInt(item.lots[index].quantity || 0);\n\n    if (index <= 0 || item.lots[index].quantity <= 0) {\n      if (item.lots[0].quantity > 0) {\n        item.lots[0].quantity -= 1;\n      }\n    } else {\n      if (item.lots[index].quantity > 0) {\n        item.lots[index].quantity -= 1;\n      }\n    }\n\n    return this;\n  }\n\n  increment(index) {\n    var item = this.item;\n\n    index = index || 0;\n\n    if (index >= item.lots.length) {\n      return this;\n    }\n\n    item.lots[index].quantity = parseInt(item.lots[index].quantity || 0);\n    item.lots[index].maxQty = parseInt(item.lots[index].maxQty || 0);\n\n    if (item.lots[index].quantity + 1 > item.lots[index].maxQty) {\n      return this.increment(index + 1);\n    } else {\n      item.lots[index].quantity += 1;\n    }\n\n    return this;\n  }\n}\n\n'use strict';\n\nclass ItemNoLots {\n  constructor(item) {\n    item = item || {};\n    item.noLots = item.noLots || {};\n\n    //Set max quantity and initial quantity\n    Object.assign(item.noLots, {\n      maxQty: item.noLots.quantity,\n      quantity: 1\n    });\n\n    this.item = item;\n  }\n\n  get() {\n    return this.item;\n  }\n\n  set(item) {\n    this.item = item;\n  }\n\n  decrement() {\n    var item = this.item;\n    item.noLots.quantity = parseInt(item.noLots.quantity || 0);\n\n    if (item.noLots.quantity > 0) {\n      item.noLots.quantity -= 1;\n    }\n\n    return this;\n  }\n\n  increment() {\n    var item = this.item;\n\n    item.noLots.quantity = parseInt(item.noLots.quantity || 0);\n    item.noLots.maxQty = parseInt(item.noLots.maxQty || 0);\n\n    if (item.noLots.quantity + 1 <= item.noLots.maxQty) {\n      item.noLots.quantity += 1;\n    }\n\n    return this;\n  }\n}\n"]}