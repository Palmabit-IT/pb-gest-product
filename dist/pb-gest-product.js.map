{"version":3,"sources":["pb-gest-product.js"],"names":[],"mappings":"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","file":"pb-gest-product.js","sourcesContent":["/*! pb-gest-product 0.13.1 - Copyright 2016 Palmabit <hello@palmabit.com> (http://www.palmabit.com) */\n'use strict';\n\nclass ItemFactory {\n  constructor(item) {\n    this.item = item;\n\n    if (!item) {\n      throw new Error('item must be an object');\n    }\n\n    if (item.intangible) {\n      return new ItemIntangible(item);\n    } else {\n      return new ItemLots(item);\n    }\n  }\n}\n\n'use strict';\n\nclass ItemIntangible {\n  constructor(item) {\n    item = item || {};\n    //Set initial quantity\n    item.quantity = 1;\n\n    this.item = item;\n  }\n\n  get() {\n    return this.item;\n  }\n\n  set(item) {\n    this.item = item;\n  }\n\n  decrement(index) {\n    var item = this.item;\n    item.quantity = parseInt(item.quantity || 0);\n\n    if (item.quantity > 0) {\n      item.quantity -= 1;\n    }\n\n    return this;\n  }\n\n  increment(index) {\n    var item = this.item;\n    item.quantity = parseInt(item.quantity || 0);\n    item.quantity += 1;\n    return this;\n  }\n}\n\n'use strict';\n\nclass ItemLots {\n  constructor(item) {\n    item = item || {};\n    item.lots = item.lots || [];\n\n    this.item = item;\n\n    //Set max quantity and initial quantity\n    item.lots.forEach(function (lot, i) {\n      lot.maxQty = lot.quantity;\n      lot.quantity = i == 0 ? 1 : 0;\n    });\n  }\n\n  get() {\n    return this.item;\n  }\n\n  set(item) {\n    this.item = item;\n  }\n\n  decrement(index) {\n    var item = this.item;\n\n    if (item.lots.length === 0) {\n      return this;\n    }\n\n    index = index || item.lots.length - 1;\n    item.lots[index].quantity = parseInt(item.lots[index].quantity || 0);\n\n    if (index <= 0 || item.lots[index].quantity <= 0) {\n      if (item.lots[0].quantity > 0) {\n        item.lots[0].quantity -= 1;\n      }\n    } else {\n      if (item.lots[index].quantity > 0) {\n        item.lots[index].quantity -= 1;\n      }\n    }\n\n    return this;\n  }\n\n  increment(index) {\n    var item = this.item;\n\n    index = index || 0;\n\n    if (index >= item.lots.length) {\n      return this;\n    }\n\n    item.lots[index].quantity = parseInt(item.lots[index].quantity || 0);\n    item.lots[index].maxQty = parseInt(item.lots[index].maxQty || 0);\n\n    if (item.lots[index].quantity + 1 > item.lots[index].maxQty) {\n      return this.increment(index + 1);\n    } else {\n      item.lots[index].quantity += 1;\n    }\n\n    return this;\n  }\n}\n\n'use strict';\n\nclass ItemManager {\n  constructor(item) {\n    if (!item) {\n      throw new Error('item must be an object');\n    }\n\n    item.quantity = item.quantity || 0;\n    this.item = item;\n  }\n\n  get() {\n    return this.item;\n  }\n\n  set(item) {\n    this.item = item;\n  }\n\n  decrement() {\n    var item = this.item;\n\n    if (item.quantity > 0) {\n      item.quantity -= 1;\n    }\n\n    return this;\n  }\n\n  increment() {\n    var item = this.item;\n\n    if (item.intangible || !item.maxQty || item.quantity < item.maxQty) {\n      item.quantity += 1;\n    }\n\n    return this;\n  }\n}\n\n'use strict';\n\nclass AbstractVersionable {\n  constructor (obj) {\n    this.obj = obj;\n  }\n\n  /**\n   * Check if object has a version\n   * @param obj\n   * @returns {*|boolean}\n   */\n  hasVersion(obj) {\n    return obj && typeof obj.version !== 'undefined' && obj.version;\n  }\n\n  /**\n   * Check if object has an array of versions\n   * @returns {*|boolean}\n   */\n  hasVersions() {\n    return this.obj && Array.isArray(this.obj.versions) && this.obj.versions.length > 0;\n  }\n\n  /**\n   * Find an object's version by name\n   * @param versionName\n   * @returns {*}\n   */\n  findVersion(versionName) {\n    if (!versionName || !this.hasVersions()) {\n      return;\n    }\n\n    for (let v of this.obj.versions) {\n      if (v && v.name === versionName) {\n        return v;\n      }\n    }\n  }\n\n  /**\n   * Check if version is active\n   * @param version\n   * @returns {*|boolean}\n   */\n  isActive(version) {\n    return version && version.active === true;\n  }\n\n  /**\n   * Check if version is valid\n   * @param version\n   * @returns {boolean}\n   */\n  isValid(version) {\n    var start, end,\n        now = Date.now();\n\n    if (!version) {\n      return false;\n    }\n\n    if (version.start) {\n      start = new Date(version.start);\n    }\n    if (version.end) {\n      end = new Date(version.end);\n    }\n\n    return (!start || start <= now) && (!end || end >= now);\n  }\n\n  /**\n   * Check if object has a valid version\n   * @returns {boolean}\n   */\n  hasValidVersion() {\n    if (!this.hasVersions()) {\n      return false;\n    }\n\n    for (let v of this.obj.versions) {\n      if (this.isActive(v) && this.isValid(v)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n}\n\n'use strict';\n\nclass ProductItemConverter {\n  constructor() {\n    this.items = [];\n    this.maxReached = [];\n    this.products = [];\n  }\n\n  /**\n   * Add products to items list\n   * @param products\n   * @param items\n   * @returns {*}\n   */\n  add(products, items) {\n    this.products = [];\n    this.items = items;\n    this.maxReached = [];\n\n    for (let product of products) {\n      this._addProduct(product);\n    }\n\n    return this._merge();\n  }\n\n  /**\n   * Get items list\n   * @returns {*|Array}\n   */\n  get() {\n    return this.items;\n  }\n\n  /**\n   * Get maxReached\n   * @returns {Array}\n   */\n  getMaxReached() {\n    return this.maxReached;\n  }\n\n  /**\n   * Check if errors\n   * @returns {boolean}\n   */\n  hasErrors() {\n    return this.maxReached.length > 0;\n  }\n\n  _addProduct(product) {\n    if (!product) {\n      return;\n    }\n\n    product.intangible === true ? this._addProductIntangible(product) : this._addProductWithLots(product);\n  }\n\n  _addProductWithLots(product) {\n    //Split lots\n    for (let lot of product.lots) {\n      let item;\n\n      if (!lot.quantity || lot.quantity === 0) {\n        continue;\n      }\n\n      item = this._create(product, lot);\n\n      if (item.lots) {\n        delete item.lots;\n      }\n\n      this.products.push(item);\n    }\n  }\n\n  _addProductIntangible(product) {\n    this.products.push(product);\n  }\n\n  _create(product, lot) {\n    lot = lot || {};\n\n    return Object.assign({}, product, {\n      quantity: lot.quantity,\n      maxQty: lot.maxQty,\n      lot: {\n        lot: lot.lot,\n        date: lot.date,\n        expiration: lot.expiration\n      },\n      warehouse: lot.warehouse\n    });\n  }\n\n  _merge() {\n    for (let product of this.products) {\n      let found = false;\n\n      for (let item of this.items) {\n        if (product._id !== item._id) {\n          continue;\n        }\n\n        if ((product.intangible === true) || (!product.hasLots && this._areDatesEqual(product.lot, item.lot))) {\n          found = true;\n          this._incrementItems(product, item);\n        } else if (product.lot.lot === item.lot.lot && this._areDatesEqual(product.lot, item.lot)) {\n          found = true;\n          this._incrementItems(product, item);\n        }\n      };\n\n      if (!found) {\n        this.items.push(product);\n      }\n    };\n  }\n\n  _incrementItems(product, item) {\n    if (product.intangible === true || !item.maxQty || product.quantity + item.quantity <= item.maxQty) {\n      item.quantity = product.quantity + item.quantity;\n    } else {\n      item.quantity = item.maxQty;\n\n      this.maxReached.push({\n        description: item.description,\n        lot: item.lot && item.lot.lot ? item.lot.lot : '-'\n      });\n    }\n  }\n\n  _areDatesEqual(productLot, itemLot) {\n    var date1, date2;\n    var exp1 = productLot.expiration;\n    var exp2 = itemLot.expiration;\n\n    if (!exp1 && !exp2) {\n      return true;\n    } else if (!exp1 || !exp2) {\n      return false;\n    }\n\n    date1 = new Date(exp1);\n    date2 = new Date(exp2);\n\n    return date1.getFullYear() === date2.getFullYear() && date1.getMonth() === date2.getMonth() && date1.getDate() === date2.getDate();\n  }\n}\n\n'use strict';\n\nclass ProductPresenter {\n  constructor(user) {\n    this.user = user || {};\n  }\n\n  getUser() {\n    return this.user;\n  }\n\n  setUser(user) {\n    this.user = user || {};\n  }\n\n  /**\n   * Present a list of products\n   * @param products\n   * @returns {*}git\n   */\n  presentList(products, options) {\n    var i;\n\n    for (i = 0; i < products.length; i += 1) {\n      this.present(products[i], options);\n    }\n\n    return products;\n  }\n\n  /**\n   * Present a single product\n   * @param product\n   * @returns {*}\n   */\n  present(product, options) {\n    if (typeof product !== 'object') {\n      throw new TypeError('product must be an object');\n    }\n\n    if (!product.price) {\n      this.getPrice(product, options);\n    }\n\n    this.getQuantity(product);\n\n    return product;\n  }\n\n  /**\n   * Get product price\n   * @param product\n   * @param options\n   * @returns {*}\n   */\n  getPrice(product, options) {\n    var i, user = this.user;\n\n    if (this.getListPrice(product, user.list_custom, 'c', options)) {      //priority 1\n      return product;\n    }\n    if (this.getListPrice(product, user.list_base, 'b', options)) {        //priority 2\n      return product;\n    }\n    if (this.getListPrice(product, user.list_default, 'd', options)) {     //priority 3\n      return product;\n    }\n\n    product.price = 0;\n    return product;\n  }\n\n  /**\n   * Get product price from a list\n   * @param product\n   * @param list\n   * @param type\n   * @param options\n   * @returns {*}\n   */\n  getListPrice(product, list, type, options) {\n    if (!Array.isArray(product.prices) || !list) {\n      return\n    }\n\n    if (list && options && list.include_vat !== options.include_vat) {\n      return;\n    }\n\n    for (var i = 0; i < product.prices.length; i += 1) {\n      if (product.prices[i].list === list._id) {\n        let productPrice = new ProductPrice(list, product.prices[i]);\n        product.price = productPrice.getPrice();\n        product.discount = productPrice.getDiscount() || this.getDiscountList(product.prices[i]);\n        product.list = this.getListData(list, type);\n        product.include_vat = !!list.include_vat;\n        return product;\n      }\n    }\n  }\n\n  /**\n   * Get discounts from user's discount list\n   * @param productPrices\n   * @returns {*}\n   */\n  getDiscountList(productPrices) {\n    if (!this.user.list_discount) {\n      return;\n    }\n\n    let productPrice = new ProductPrice(this.user.list_discount, productPrices);\n    return productPrice.getDiscount();\n  }\n\n  /**\n   * Get product quantity\n   * @param product\n   * @returns {*}\n   */\n  getQuantity(product) {\n    if (product.intangible === true) {\n      return product;\n    }\n\n    return this.getQuantityFromLots(product);\n  }\n\n  /**\n   * Get product quantity from lots\n   * @param product\n   * @returns {*}\n   */\n  getQuantityFromLots(product) {\n    if (product.lots && product.lots.length > 0) {\n      product.quantity = 0;\n\n      product.lots.sort(function (a, b) {\n        if (a.expiration && b.expiration) {\n          return new Date(a.expiration) - new Date(b.expiration);\n        } else {\n          return new Date(a.date) - new Date(b.date);\n        }\n      });\n\n      for (var i = 0; i < product.lots.length; i += 1) {\n        product.quantity += product.lots[i].quantity;\n      }\n    }\n\n    return product;\n  }\n\n  /**\n   * Get list data\n   * @param list\n   * @param type\n   * @returns {{_id: *, code: (*|string|string|number|Number|string), name: string, type: string}}\n   */\n  getListData(list = {}, type = '') {\n    return {\n      _id: list._id,\n      code: list.code || '',\n      name: list.name || '',\n      type: type\n    }\n  }\n}\n\n'use strict';\n\nclass ProductPrice extends AbstractVersionable {\n  constructor (list, productPrice) {\n    super(list);\n\n    this.list = list;\n    this.productPrice = productPrice;\n\n    if (typeof list !== 'object') {\n      throw new TypeError('list must be an object');\n    }\n\n    if (typeof productPrice !== 'object') {\n      throw new TypeError('product price must be an object');\n    }\n  }\n\n  /**\n   * Get product price\n   * @returns {*}\n   */\n  getPrice() {\n    return this.productPriceHasVersion() ? this._getPriceWithVersion() : this._getPriceWithoutVersion();\n  }\n\n  _getPriceWithVersion() {\n    var version = this.findVersion(this.productPrice.version);\n\n    if (version && this.isActive(version) && this.isValid(version)) {\n      return this.productPrice.price || 0;\n    }\n\n    return 0;\n  }\n\n  _getPriceWithoutVersion() {\n    if (this.isValid(this.list) || this.hasValidVersion()) {\n      return this.productPrice.price || 0;\n    }\n\n    return 0;\n  }\n\n  /**\n   * Check if product price has a version\n   * @returns {boolean|string}\n   */\n  productPriceHasVersion() {\n    return typeof this.productPrice.version !== 'undefined' && this.productPrice.version;\n  }\n\n  /**\n   * Get product's discount\n   * @returns {*}\n   */\n  getDiscount() {\n    return this.productPriceHasVersion() ? this._getDiscountWithVersion() : this._getDiscountWithoutVersion();\n  }\n\n  _getDiscountWithVersion() {\n    var version = this.findVersion(this.productPrice.version);\n\n    if (version && this.isActive(version) && this.isValid(version)) {\n      return version.discount;\n    }\n\n    return;\n  }\n\n  _getDiscountWithoutVersion() {\n    if (this.isValid(this.list) || this.hasValidVersion()) {\n      return this.list.discount;\n    }\n\n    return;\n  }\n}\n\n'use strict';\n\nclass ProductVatPresenter extends ProductPresenter {\n\n  /**\n   * Present a product with VAT\n   * @param product\n   * @returns {*}\n   */\n  present(product) {\n    super.present(product);\n    product.vat = this.getVat(product);\n    return product;\n  }\n\n  /**\n   * Get product's VAT\n   * @param product\n   * @returns {*}\n   */\n  getVat(product) {\n    product.rate_reduced = product.rate_reduced || [];\n\n    if (product.rate_exemption) {             //product's vat exemption\n      return product.rate_exemption;\n    } else if (this.user.rate_exemption) {    //user's vat exemption\n      return this.user.rate_exemption;\n    } else if (this.user.rate) {              //user's vat reduced\n      return this.getVatReduced(product);\n    } else if (product.rate) {                //product's regular vat\n      return product.rate;\n    } else {                                  //default vat\n      return this.user.rate_default || null;\n    }\n  }\n\n  /**\n   * Get product's VAT reduced\n   * @param product\n   * @returns {*}\n   */\n  getVatReduced(product) {\n    var i, reduced;\n\n    for (i = 0; i < product.rate_reduced.length; i += 1) {\n      reduced = product.rate_reduced[i];\n\n      if (reduced && reduced.name === this.user.rate) {\n        return reduced.vat;\n      }\n    }\n\n    //Product's regular vat is returned if reduced one is not found\n    return product.rate;\n  }\n}\n"]}